<!DOCTYPE html>

<!-- saved from url=(0227)file:///Users/michaelmacair/Desktop/Nordic%20Trip%20Aug%202025/%E5%8C%97%E6%AD%90%E8%A8%AD%E8%A8%88%E8%88%87%E6%96%87%E5%8C%96%E6%85%A2%E6%97%85%20%E2%80%93%20%E8%A1%8C%E7%A8%8B%E8%88%87%E6%B6%88%E8%B2%BB%E8%A8%98%E9%8C%84.html -->
<html lang="zh-HK"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>北歐設計與文化慢旅 – 行程與消費記錄</title>
<style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f5f5f5;
      color: #333;
    }
    header {
      background: #20415a;
      color: #fff;
      padding: 20px;
      text-align: center;
    }
    nav {
      background: #e0e7ef;
      padding: 10px 20px;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    nav a {
      margin-right: 15px;
      color: #20415a;
      text-decoration: none;
      font-weight: bold;
    }
    section {
      padding: 20px;
      background: #fff;
      margin: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    h2 {
      color: #20415a;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
    }
    th {
      background: #20415a;
      color: #fff;
    }
    button {
      padding: 6px 12px;
      margin: 0 5px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .edit-btn { background: #f0ad4e; color: #fff; }
    .delete-btn { background: #d9534f; color: #fff; }
    .save-btn { background: #5cb85c; color: #fff; }
    .cancel-btn { background: #6c757d; color: #fff; }
    .totals {
      margin-top: 10px;
      font-weight: bold;
    }
    .expense-form {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
    }
    .expense-form input, .expense-form select {
      margin-right: 10px;
      margin-bottom: 10px;
      padding: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .expense-form button {
      margin-top: 5px;
    }
    footer {
      text-align: center;
      padding: 20px;
      background: #20415a;
      color: #fff;
    }
  </style>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport"/><link href="manifest.json" rel="manifest"/></head>
<body>
<header>
<h1>北歐設計與文化慢旅 – 行程與消費記錄</h1>
<p>2025 年 8 月</p>
</header>
<nav>
<!-- Navigation links to quickly jump to each day -->
<a href="#day10">8/10 哥本哈根</a>
<a href="#day11">8/11 哥本哈根</a>
<a href="#day12">8/12 哥本哈根</a>
<a href="#day13">8/13 哥本哈根</a>
<a href="#day14">8/14 赫爾辛基</a>
<a href="#day15">8/15 塔林一日遊</a>
<a href="#day16">8/16 藝術與自然探索</a>
<a href="#day17">8/17 赫爾辛基</a>
<a href="#day18">8/18 赫爾辛基</a>
<a href="#day19">8/19 退房返航準備</a>
<a href="#analysis">消費分析</a>
</nav>
<!-- Day sections -->
<section id="day10">
<h2>8月10日（日） – 抵達哥本哈根</h2>
<p>本日為旅程的第一個完整日。您於前一晚（8 月 9 日）自香港國際機場起飛，搭乘芬蘭航空 <strong>AY100</strong> 班機於晚上 20:55 出發，經過約十二小時航程於翌日 5:35 抵達赫爾辛基。稍作停留後再轉乘 <strong>AY965/AY966</strong> 前往哥本哈根的航班 11:00 起飛，11:40 到達卡斯楚普機場。從機場搭乘地鐵或區域火車進入市區只需 13–15 分鐘【834585865502211†L37-L59】【528394835771643†L90-L94】，步行約 10 分鐘即能抵達住宿的 Scandic Spectrum 酒店。安頓後，下午可乘坐 Nyhavn 運河遊船欣賞色彩繽紛的房子，之後前往大理石教堂 (Marble Church) 等候 13:30 的圓頂開放時間。接著順路漫步至皇家圖書館花園 (Royal Library Garden) 享受靜謐綠意，晚間可自由遊覽港口。</p>
<ul>
<li><strong>Nyhavn 運河遊船</strong> – 船程約 1 小時，可現場購票。</li>
<li><strong>大理石教堂</strong> – 教堂於周日 13:00 開放，13:30 可爬上圓頂俯瞰城市【642118220967409†L35-L45】。</li>
<li><strong>皇家圖書館花園</strong> – 公園免費開放，全天候開放，是放鬆散步的好去處【513673219197027†L454-L460】。</li>
</ul>
<h3>當日消費</h3>
<table id="expenses-day10">
<thead>
<tr>
<th>項目</th><th>類別</th><th>金額 (HK$)</th><th>操作</th>
</tr>
</thead>
<tbody><tr>
<td>來回機票總數</td>
<td>交通</td>
<td>18854.00</td>
<td><button class="edit-btn" onclick="editExpense('day10', 'zmtvu2ouo')">編輯</button><button class="delete-btn" onclick="deleteExpense('day10', 'zmtvu2ouo')">刪除</button></td>
</tr><tr>
<td>住宿：Scandic Spectrum (4晚)</td>
<td>住宿</td>
<td>7275.49</td>
<td><button class="edit-btn" onclick="editExpense('day10', 'tbtu3qrun')">編輯</button><button class="delete-btn" onclick="deleteExpense('day10', 'tbtu3qrun')">刪除</button></td>
</tr><tr>
<td>Copenhagen Card Discover 72h (數碼卡)X2</td>
<td>門票</td>
<td>2448.00</td>
<td><button class="edit-btn" onclick="editExpense('day10', 's2l1s7gsf')">編輯</button><button class="delete-btn" onclick="deleteExpense('day10', 's2l1s7gsf')">刪除</button></td>
</tr></tbody>
</table>
<div class="totals" id="totals-day10">合計：HK$28577.49</div>
<div class="expense-form" data-day="day10">
<input name="name" placeholder="項目名稱" type="text"/>
<select name="category">
<option value="飲食">飲食</option>
<option value="交通">交通</option>
<option value="住宿">住宿</option>
<option value="門票">門票</option>
<option value="其他">其他</option>
</select>
<input min="0" name="amount" placeholder="金額" step="0.01" type="number"/>
<select name="currency">
<option value="HKD">HK$</option>
<option value="EUR">€</option>
<option value="DKK">DKK</option>
</select>
<button class="save-btn" onclick="addExpense('day10')">新增</button>
</div>
</section>
<section id="day11">
<h2>8月11日（一） – 城市探索與設計購物</h2>
<p>上午觀看阿美琳堡宮衛兵交接，接著參觀丹麥設計博物館並在館內 Format Café 用午餐。午後造訪 HAY House 與 Ferm Living 設計店，傍晚登上圓塔 Round Tower 俯瞰城市，晚上於 Pluto 餐廳享用晚餐。</p>
<ul>
<li><strong>阿美琳堡王宮</strong> – 夏季每天開放，可在線預約時段並憑 Copenhagen Card 入場。</li>
<li><strong>丹麥設計博物館與 Format Café</strong> – 7–9 月期間博物館逢週一亦開放 10:00–18:00，館內 Format Café 同期營業至 18:00（週四延長至 20:00）【321842355609960†L366-L374】。</li>
<li><strong>HAY House</strong> – 週一至週六 10:00–18:00，週日 11:00–17:00【413666331648892†L221-L224】。</li>
<li><strong>Ferm Living Boutique</strong> – 週一至週五 10:00–18:00，週末 10:00–16:00【870995454220278†L37-L41】。</li>
<li><strong>圓塔</strong> – 每日 10:00–20:00，登塔可欣賞市景【513862460240169†L63-L71】。</li>
<li><strong>Pluto 餐廳</strong> – 週一至週四 17:30–00:00，週五至週六營業至 02:00，週日 17:30–23:00【984022797956727†L92-L107】，建議預訂。</li>
</ul>
<h3>當日消費</h3>
<table id="expenses-day11">
<thead>
<tr>
<th>項目</th><th>類別</th><th>金額 (HK$)</th><th>操作</th>
</tr>
</thead>
<tbody></tbody>
</table>
<div class="totals" id="totals-day11">合計：HK$0.00</div>
<div class="expense-form" data-day="day11">
<input name="name" placeholder="項目名稱" type="text"/>
<select name="category">
<option value="飲食">飲食</option>
<option value="交通">交通</option>
<option value="住宿">住宿</option>
<option value="門票">門票</option>
<option value="其他">其他</option>
</select>
<input min="0" name="amount" placeholder="金額" step="0.01" type="number"/>
<select name="currency">
<option value="HKD">HK$</option>
<option value="EUR">€</option>
<option value="DKK">DKK</option>
</select>
<button class="save-btn" onclick="addExpense('day11')">新增</button>
</div>
</section>
<section id="day12">
<h2>8月12日（二） – 美食、啤酒與歷史</h2>
<p>上午可前往海濱咖啡店 La Banchina 享用早餐，隨後回市區逛 Torvehallerne 市場品嚐當地食材。中午遊覽羅森堡宮和國王花園，下午 16:00 參加 Home of Carlsberg 導覽，晚上前往 Absalon 社區中心參加瑜伽或共享晚餐。</p>
<ul>
<li><strong>La Banchina</strong> – 夏季每天 08:00–22:00；提供咖啡與天然酒【177463952479718†L84-L86】。</li>
<li><strong>Torvehallerne 市場</strong> – 市場匯聚各式丹麥食品與生鮮。</li>
<li><strong>羅森堡宮與國王花園</strong> – 城堡 6/28–9/14 每天 09:00–17:00【34664859525360†L534-L543】，花園夏季 07:00–22:00【292368594846055†L63-L65】。</li>
<li><strong>Home of Carlsberg</strong> – 展覽每天 10:00–20:00 開放，預約導覽必須在網上提前訂票【552880362469114†L15-L40】。</li>
<li><strong>Absalon CPH</strong> – 社區中心每天 07:30–00:00，周五至凌晨 02:00，晚餐 18:00–19:15；晚上 19:15–20:30 有 Aftenyoga 【867281301750893†L34-L56】【729457008012773†L34-L63】。</li>
<li><strong>備忘提醒：</strong> Absalon 的共用晚餐票通常只會提前幾週開放，8 月 12 日的晚餐預計在 8 月初開售，請留意官網並及時訂票。</li>
</ul>
<h3>當日消費</h3>
<table id="expenses-day12">
<thead>
<tr>
<th>項目</th><th>類別</th><th>金額 (HK$)</th><th>操作</th>
</tr>
</thead>
<tbody></tbody>
</table>
<div class="totals" id="totals-day12">合計：HK$0.00</div>
<div class="expense-form" data-day="day12">
<input name="name" placeholder="項目名稱" type="text"/>
<select name="category">
<option value="飲食">飲食</option>
<option value="交通">交通</option>
<option value="住宿">住宿</option>
<option value="門票">門票</option>
<option value="其他">其他</option>
</select>
<input min="0" name="amount" placeholder="金額" step="0.01" type="number"/>
<select name="currency">
<option value="HKD">HK$</option>
<option value="EUR">€</option>
<option value="DKK">DKK</option>
</select>
<button class="save-btn" onclick="addExpense('day12')">新增</button>
</div>
</section>
<section id="day13">
<h2>8月13日（三） – 藝術、咖啡與美食</h2>
<p>上午於 The Sixteen Twelve 享用澳洲風早午餐，隨後參觀 Ny Carlsberg Glyptotek；午餐可前往 Selma 享用瑞典風 Smørrebrød。下午自由購物或散步，晚餐預訂位於 Vesterbro 的現代披薩餐廳 Surt。</p>
<ul>
<li><strong>The Sixteen Twelve</strong> – 周一至周五 09:00–16:00，週末 08:00–16:00【457876865113384†L16-L21】。</li>
<li><strong>Ny Carlsberg Glyptotek</strong> – 博物館週二至周日 10:00–17:00 開放【958709213375311†L119-L142】。</li>
<li><strong>Selma 餐廳</strong> – 午餐 週三至週一 11:30–16:00，晚餐 週三至週六 18:30–23:00【867487903956925†L91-L103】。</li>
<li><strong>Surt 餐廳</strong> – Carlsberg Byen 的現代披薩餐廳，晚餐時間 16:30–21:30【668102325542991†L60-L88】，建議提前預約。</li>
</ul>
<h3>當日消費</h3>
<table id="expenses-day13">
<thead>
<tr>
<th>項目</th><th>類別</th><th>金額 (HK$)</th><th>操作</th>
</tr>
</thead>
<tbody></tbody>
</table>
<div class="totals" id="totals-day13">合計：HK$0.00</div>
<div class="expense-form" data-day="day13">
<input name="name" placeholder="項目名稱" type="text"/>
<select name="category">
<option value="飲食">飲食</option>
<option value="交通">交通</option>
<option value="住宿">住宿</option>
<option value="門票">門票</option>
<option value="其他">其他</option>
</select>
<input min="0" name="amount" placeholder="金額" step="0.01" type="number"/>
<select name="currency">
<option value="HKD">HK$</option>
<option value="EUR">€</option>
<option value="DKK">DKK</option>
</select>
<button class="save-btn" onclick="addExpense('day13')">新增</button>
</div>
</section>
<section id="day14">
<h2>8月14日（四） – 赫爾辛基初到</h2>
<p>上午從哥本哈根市中心前往卡斯楚普機場，搭乘芬蘭航空 <strong>AY966</strong> 航班，12:25 起飛、14:55 抵達赫爾辛基。從市區搭乘地鐵或火車前往機場僅需約 13–15 分鐘【834585865502211†L37-L59】【528394835771643†L90-L94】，建議預留時間辦理退房與安檢。抵達赫爾辛基後入住 Scandic Grand Central Helsinki。由於抵達時間較早，可先前往市中心參議院廣場：下午造訪【377426902445162†L166-L183】赫爾辛基大教堂（夏季週一至週四 09:00–17:00、週五至 14:00，18:00–21:00 免票入內）與【630432462548965†L229-L235】烏斯別斯基東正教座堂（週二至週五 09:30–16:00、週六 10:00–15:00、週日 12:00–15:00，週一休息）。午餐可在老市集大廳 Old Market Hall（週一至週六 08:00–18:00、週日 10:00–17:00）【638528237286460†L25-L34】內的 Story 餐廳品嚐海鮮，之後漫步 Esplanadi 公園並在開到午夜的 Kappeli 咖啡館小憩【981575967308264†L94-L100】。晚餐建議預訂營業時間為 12:00–23:00（週日 17:00–23:00）的 Savotta 餐廳【612110480888358†L124-L130】。</p>
<ul>
<li><strong>赫爾辛基大教堂</strong> – 夏季週一至週四09:00–17:00、週五至14:00，晚間18:00–21:00開放【377426902445162†L166-L183】。</li>
<li><strong>烏斯別斯基東正教座堂</strong> – 週二至週五09:30–16:00、週六10:00–15:00、週日12:00–15:00，週一關閉【630432462548965†L229-L235】。</li>
<li><strong>老市集大廳 Old Market Hall</strong> – 週一至週六08:00–18:00、週日10:00–17:00【638528237286460†L25-L34】。</li>
<li><strong>Kappeli 咖啡館</strong> – 每天 09:00–24:00【981575967308264†L94-L100】。</li>
<li><strong>Savotta 餐廳</strong> – 週一至週六 12:00–23:00，週日 17:00–23:00【612110480888358†L124-L130】，建議預約。</li>
</ul>
<h3>當日消費</h3>
<table id="expenses-day14">
<thead>
<tr>
<th>項目</th><th>類別</th><th>金額 (HK$)</th><th>操作</th>
</tr>
</thead>
<tbody><tr>
<td>住宿：Scandic Grand Central (5晚)</td>
<td>住宿</td>
<td>8524.72</td>
<td><button class="edit-btn" onclick="editExpense('day14', 'wg7cruozw')">編輯</button><button class="delete-btn" onclick="deleteExpense('day14', 'wg7cruozw')">刪除</button></td>
</tr></tbody>
</table>
<div class="totals" id="totals-day14">合計：HK$8524.72</div>
<div class="expense-form" data-day="day14">
<input name="name" placeholder="項目名稱" type="text"/>
<select name="category">
<option value="飲食">飲食</option>
<option value="交通">交通</option>
<option value="住宿">住宿</option>
<option value="門票">門票</option>
<option value="其他">其他</option>
</select>
<input min="0" name="amount" placeholder="金額" step="0.01" type="number"/>
<select name="currency">
<option value="HKD">HK$</option>
<option value="EUR">€</option>
<option value="DKK">DKK</option>
</select>
<button class="save-btn" onclick="addExpense('day14')">新增</button>
</div>
</section>
<section id="day15">
<h2>8月15日（五） – 塔林一日遊</h2>
<p>本日安排塔林一日遊，搭乘 Eckerö Line 芬蘭尼亞號渡輪前往塔林並於傍晚返航。</p>
<ul>
<li><strong>去程</strong> – 08:15 抵達西港客運碼頭 T2 辦理登船；09:00 開船，11:15 抵達塔林。須於開船前 45 分鐘完成報到、30 分鐘前完成登船【932823432791288†L31-L36】。</li>
<li><strong>塔林舊城自由行</strong> – 漫步市政廳廣場與托姆比亞山，享受中世紀風情。</li>
<li><strong>回程</strong> – 18:30 從塔林起航，21:00 返抵赫爾辛基【932823432791288†L31-L36】。</li>
</ul>
<h3>當日消費</h3>
<table id="expenses-day15">
<thead>
<tr>
<th>項目</th><th>類別</th><th>金額 (HK$)</th><th>操作</th>
</tr>
</thead>
<tbody><tr>
<td>船票：赫爾辛基↔塔林</td>
<td>交通</td>
<td>374.00</td>
<td><button class="edit-btn" onclick="editExpense('day15', 'y7zairvqo')">編輯</button><button class="delete-btn" onclick="deleteExpense('day15', 'y7zairvqo')">刪除</button></td>
</tr></tbody>
</table>
<div class="totals" id="totals-day15">合計：HK$374.00</div>
<div class="expense-form" data-day="day15">
<input name="name" placeholder="項目名稱" type="text"/>
<select name="category">
<option value="飲食">飲食</option>
<option value="交通">交通</option>
<option value="住宿">住宿</option>
<option value="門票">門票</option>
<option value="其他">其他</option>
</select>
<input min="0" name="amount" placeholder="金額" step="0.01" type="number"/>
<select name="currency">
<option value="HKD">HK$</option>
<option value="EUR">€</option>
<option value="DKK">DKK</option>
</select>
<button class="save-btn" onclick="addExpense('day15')">新增</button>
</div>
</section>
<section id="day16">
<h2>8月16日（六） – 赫爾辛基藝術與自然探索</h2>
<p>今天在赫爾辛基市區深入體驗藝術與自然：上午參觀 Kiasma 現代藝術博物館（週六 10:00–18:00）與相鄰的 Ateneum 美術館（夏季 10:00–18:00），欣賞芬蘭現代與經典藝術。午餐後前往由岩石雕鑿而成的【402239861650211†L183-L186】岩石教堂 Temppeliaukio（週六 10:00–17:00；演出時短暫閉館），隨後步行至西貝流士公園欣賞【630432462548965†L181-L186】西貝流士紀念碑。下午可在海邊的【577137947161571†L100-L111】Cafe Regatta（每日 09:00–22:00）享用點心，或購票體驗【532163640773692†L208-L221】Allas Sea Pool（週六 06:30–23:00，入場需於閉館前 40 分鐘入內）或預約【987165582219351†L68-L154】Löyly 桑拿（週六 09:00–11:00 及 13:00–23:00）。</p>
<h3>當日消費</h3>
<table id="expenses-day16">
<thead>
<tr>
<th>項目</th><th>類別</th><th>金額 (HK$)</th><th>操作</th>
</tr>
</thead>
<tbody></tbody>
</table>
<div class="totals" id="totals-day16">合計：HK$0.00</div>
<div class="expense-form" data-day="day16">
<input name="name" placeholder="項目名稱" type="text"/>
<select name="category">
<option value="飲食">飲食</option>
<option value="交通">交通</option>
<option value="住宿">住宿</option>
<option value="門票">門票</option>
<option value="其他">其他</option>
</select>
<input min="0" name="amount" placeholder="金額" step="0.01" type="number"/>
<select name="currency">
<option value="HKD">HK$</option>
<option value="EUR">€</option>
<option value="DKK">DKK</option>
</select>
<button class="save-btn" onclick="addExpense('day16')">新增</button>
</div>
</section>
<section id="day17">
<h2>8月17日（日） – 赫爾辛基悠閒日</h2>
<p>上午探訪 Lapinlahti 前精神病院園區，該園區已轉型為文化聚落，週末商店與二手店於 12:00–17:00 開放【283611392250827†L94-L108】。之後漫步 Eira 與 Ullanlinna 歷史街區。午後可回市區參觀其他博物館或購物，亦可體驗【532163640773692†L208-L221】Allas Sea Pool（週日 09:00–21:00）或預約【987165582219351†L68-L154】Löyly 桑拿（週日 11:00–21:00）。晚餐推薦預訂 Juuri 現代芬蘭餐廳，週日 16:00–22:00 營業【468982412014615†L175-L211】。</p>
<h3>當日消費</h3>
<table id="expenses-day17">
<thead>
<tr>
<th>項目</th><th>類別</th><th>金額 (HK$)</th><th>操作</th>
</tr>
</thead>
<tbody></tbody>
</table>
<div class="totals" id="totals-day17">合計：HK$0.00</div>
<div class="expense-form" data-day="day17">
<input name="name" placeholder="項目名稱" type="text"/>
<select name="category">
<option value="飲食">飲食</option>
<option value="交通">交通</option>
<option value="住宿">住宿</option>
<option value="門票">門票</option>
<option value="其他">其他</option>
</select>
<input min="0" name="amount" placeholder="金額" step="0.01" type="number"/>
<select name="currency">
<option value="HKD">HK$</option>
<option value="EUR">€</option>
<option value="DKK">DKK</option>
</select>
<button class="save-btn" onclick="addExpense('day17')">新增</button>
</div>
</section>
<section id="day18">
<h2>8月18日（一） – 赫爾辛基最後一天</h2>
<p>最後完整一日以購物與設計為主：上午前往 Stockmann 百貨旗艦店逛街，超市層週一–週六 09:00–21:00、週日 10:00–21:00，樓上 2–4 層 10:00–21:00、5 樓 10:00–20:00【432741976023609†L1150-L1169】。午後搭地鐵前往 Herttoniemi 參觀 Marimekko House，逛 Marimekko Outlet（週一 10:00–18:00）並於員工餐廳 Maritori 用午餐，餐廳僅週一至週五 10:30–14:00 提供午餐【726838335643789†L31-L42】。傍晚返回市區，自由購物或重訪喜愛景點。</p>
<h3>當日消費</h3>
<table id="expenses-day18">
<thead>
<tr>
<th>項目</th><th>類別</th><th>金額 (HK$)</th><th>操作</th>
</tr>
</thead>
<tbody><tr>
<td>機票：HEL→HKG</td>
<td>交通</td>
<td>4500.00</td>
<td><button class="edit-btn" onclick="editExpense('day18', 'kvxfnl6xm')">編輯</button><button class="delete-btn" onclick="deleteExpense('day18', 'kvxfnl6xm')">刪除</button></td>
</tr></tbody>
</table>
<div class="totals" id="totals-day18">合計：HK$4500.00</div>
<div class="expense-form" data-day="day18">
<input name="name" placeholder="項目名稱" type="text"/>
<select name="category">
<option value="飲食">飲食</option>
<option value="交通">交通</option>
<option value="住宿">住宿</option>
<option value="門票">門票</option>
<option value="其他">其他</option>
</select>
<input min="0" name="amount" placeholder="金額" step="0.01" type="number"/>
<select name="currency">
<option value="HKD">HK$</option>
<option value="EUR">€</option>
<option value="DKK">DKK</option>
</select>
<button class="save-btn" onclick="addExpense('day18')">新增</button>
</div>
</section>
<section id="day19">
<h2>8月19日（二） – 退房與返航準備</h2>
<p>上午在酒店退房後可寄存行李，自由在市區或海濱散步。午後可於 16:00 開門的 Baskeri &amp; Basso Bistro（BasBas）享用晚餐；此餐廳僅在週二至週五 16:00–01:00 營業，座位有限需提前預約【890198280901039†L116-L129】。晚餐後返回酒店取回行李，前往赫爾辛基機場搭乘芬蘭航空 AY099 航班返回香港。赫爾辛基機場距離市中心約 20 公里，搭乘 I 或 P 線通勤列車約需 30 分鐘，巴士 600 號約 40–50 分鐘【408097274392933†L460-L498】。為趕上 8 月 20 日 00:35 的起飛，建議於 21:00 左右從市中心出發，預留辦理退稅、安檢和登機的時間。</p>
<h3>當日消費</h3>
<table id="expenses-day19">
<thead>
<tr>
<th>項目</th><th>類別</th><th>金額 (HK$)</th><th>操作</th>
</tr>
</thead>
<tbody></tbody>
</table>
<div class="totals" id="totals-day19">合計：HK$0.00</div>
<div class="expense-form" data-day="day19">
<input name="name" placeholder="項目名稱" type="text"/>
<select name="category">
<option value="飲食">飲食</option>
<option value="交通">交通</option>
<option value="住宿">住宿</option>
<option value="門票">門票</option>
<option value="其他">其他</option>
</select>
<input min="0" name="amount" placeholder="金額" step="0.01" type="number"/>
<select name="currency">
<option value="HKD">HK$</option>
<option value="EUR">€</option>
<option value="DKK">DKK</option>
</select>
<button class="save-btn" onclick="addExpense('day19')">新增</button>
</div>
</section>
<!-- Summary section -->
<section id="analysis">
<h2>消費分析</h2>
<p>本部分將根據您輸入的所有消費記錄，自動計算總支出及類別分佈。</p>
<div id="summary"><p>目前總支出：<strong>HK$41976.21</strong></p><ul><li>交通：HK$23728.00</li><li>住宿：HK$15800.21</li><li>門票：HK$2448.00</li></ul></div>
</section>
<footer>
<p>本行程與記帳工具為個人旅遊規劃使用，可自行調整每日行程與消費。</p>
</footer>
<script>
    // Expense data structure
    const expenses = {
      day10: [],
      day11: [],
      day12: [],
      day13: [],
      day14: [],
      day15: [],
      day16: [],
      day17: [],
      day18: [],
      day19: []
    };
    // Pre-load known expenses (approximated) for flights and hotels
    function preload() {
      expenses.day10.push({ id: generateId(), name: '機票：HKG→HEL→CPH', category: '交通', amount: 4500 });
      expenses.day10.push({ id: generateId(), name: '住宿：Scandic Spectrum (4晚)', category: '住宿', amount: 4800 });
      // Add newly purchased Copenhagen Card Discover 72h on Day 10. 133 EUR ≈ 7.464 DKK ≈ HK$1,224【599850070459322†L48-L53】
      expenses.day10.push({ id: generateId(), name: 'Copenhagen Card Discover 72h (數碼卡)', category: '門票', amount: 1224 });
      expenses.day14.push({ id: generateId(), name: '機票：CPH→HEL', category: '交通', amount: 1000 });
      expenses.day14.push({ id: generateId(), name: '住宿：Scandic Grand Central (5晚)', category: '住宿', amount: 6000 });
      expenses.day18.push({ id: generateId(), name: '機票：HEL→HKG', category: '交通', amount: 4500 });
      // 新增塔林渡輪票費用：44 歐元 ≈ HK$374
      expenses.day15.push({ id: generateId(), name: '船票：赫爾辛基↔塔林', category: '交通', amount: 374 });
    }
    // Generate unique IDs
    function generateId() {
      return Math.random().toString(36).substr(2, 9);
    }
    // On page load
    window.addEventListener('DOMContentLoaded', () => {
      preload();
      for (const day in expenses) {
        renderExpenses(day);
      }
      updateSummary();
    });
    // Add new expense entry
    function addExpense(dayKey) {
      const form = document.querySelector(`.expense-form[data-day="${dayKey}"]`);
      const name = form.querySelector('input[name="name"]').value.trim();
      const category = form.querySelector('select[name="category"]').value;
      const amountRaw = parseFloat(form.querySelector('input[name="amount"]').value);
      const currency = form.querySelector('select[name="currency"]').value;
      if (!name || isNaN(amountRaw)) {
        alert('請輸入完整項目及金額');
        return;
      }
      // Currency conversion rates to HKD (approximate mid‑2025 rates)
      const rates = { HKD: 1, EUR: 9.1, DKK: 1.23 };
      const amount = amountRaw * (rates[currency] || 1);
      expenses[dayKey].push({ id: generateId(), name, category, amount });
      // Reset form fields
      form.querySelector('input[name="name"]').value = '';
      form.querySelector('input[name="amount"]').value = '';
      form.querySelector('select[name="currency"]').value = 'HKD';
      renderExpenses(dayKey);
      updateSummary();
    }
    // Render table rows for a given day
    function renderExpenses(dayKey) {
      const tbody = document.querySelector(`#expenses-${dayKey} tbody`);
      tbody.innerHTML = '';
      let total = 0;
      expenses[dayKey].forEach((item, idx) => {
        total += item.amount;
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${item.editing ? `<input type="text" value="${item.name}" data-edit-field="name">` : item.name}</td>
          <td>${item.editing ? `<select data-edit-field="category"><option value="飲食" ${item.category==='飲食'?'selected':''}>飲食</option><option value="交通" ${item.category==='交通'?'selected':''}>交通</option><option value="住宿" ${item.category==='住宿'?'selected':''}>住宿</option><option value="門票" ${item.category==='門票'?'selected':''}>門票</option><option value="其他" ${item.category==='其他'?'selected':''}>其他</option></select>` : item.category}</td>
          <td>${item.editing ? `<input type="number" value="${item.amount}" data-edit-field="amount" min="0" step="0.1">` : item.amount.toFixed(2)}</td>
          <td>${item.editing ? `<button class="save-btn" onclick="saveEdit('${dayKey}', '${item.id}')">保存</button><button class="cancel-btn" onclick="cancelEdit('${dayKey}', '${item.id}')">取消</button>` : `<button class="edit-btn" onclick="editExpense('${dayKey}', '${item.id}')">編輯</button><button class="delete-btn" onclick="deleteExpense('${dayKey}', '${item.id}')">刪除</button>`}</td>
        `;
        tbody.appendChild(tr);
      });
      document.getElementById(`totals-${dayKey}`).innerText = `合計：HK$${total.toFixed(2)}`;
    }
    // Edit an expense
    function editExpense(dayKey, id) {
      expenses[dayKey] = expenses[dayKey].map(item => item.id === id ? { ...item, editing: true } : item);
      renderExpenses(dayKey);
    }
    // Save edits
    function saveEdit(dayKey, id) {
      const tbody = document.querySelector(`#expenses-${dayKey} tbody`);
      expenses[dayKey] = expenses[dayKey].map((item, index) => {
        if (item.id === id) {
          const row = tbody.children[index];
          const newName = row.querySelector('[data-edit-field="name"]').value;
          const newCategory = row.querySelector('[data-edit-field="category"]').value;
          const newAmount = parseFloat(row.querySelector('[data-edit-field="amount"]').value);
          return { id: item.id, name: newName, category: newCategory, amount: newAmount };
        }
        return item;
      });
      renderExpenses(dayKey);
      updateSummary();
    }
    // Cancel edit
    function cancelEdit(dayKey, id) {
      expenses[dayKey] = expenses[dayKey].map(item => item.id === id ? { ...item, editing: false } : item);
      renderExpenses(dayKey);
    }
    // Delete an expense
    function deleteExpense(dayKey, id) {
      expenses[dayKey] = expenses[dayKey].filter(item => item.id !== id);
      renderExpenses(dayKey);
      updateSummary();
    }
    // Update summary across all days
    function updateSummary() {
      let grandTotal = 0;
      const categoryTotals = {};
      for (const day in expenses) {
        expenses[day].forEach(item => {
          grandTotal += item.amount;
          categoryTotals[item.category] = (categoryTotals[item.category] || 0) + item.amount;
        });
      }
      let html = `<p>目前總支出：<strong>HK$${grandTotal.toFixed(2)}</strong></p>`;
      html += '<ul>';
      for (const cat in categoryTotals) {
        html += `<li>${cat}：HK$${categoryTotals[cat].toFixed(2)}</li>`;
      }
      html += '</ul>';
      document.getElementById('summary').innerHTML = html;
    }
  </script>
<script>
const weatherZhMap = {
  "Clear": "晴",
  "Partly Cloudy": "多雲",
  "Cloudy": "多雲",
  "Rain": "雨",
  "Thunderstorm": "雷雨",
  "Snow": "雪",
  "Drizzle": "毛毛雨",
  "Fog": "霧",
  "Haze": "霧霾"
};

function displayError(msg) {
  let errorDiv = document.getElementById('error-display');
  if (!errorDiv) {
    errorDiv = document.createElement('div');
    errorDiv.id = 'error-display';
    errorDiv.style.color = 'red';
    errorDiv.style.fontSize = '14px';
    errorDiv.style.margin = '10px';
    document.body.insertBefore(errorDiv, document.body.firstChild);
  }
  errorDiv.innerText = msg;
}

function saveRates(rates) {
  localStorage.setItem('exchangeRates', JSON.stringify(rates));
}
function loadRates() {
  const data = localStorage.getItem('exchangeRates');
  return data ? JSON.parse(data) : { rates: {EUR: 9.1, DKK: 1.23}, updatedAt: null };
}
async function fetchExchangeRates(retry = 0) {
  try {
    const res = await fetch('https://api.frankfurter.app/latest?from=EUR&to=HKD,DKK');
    const data = await res.json();
    if (!data || !data.rates || !data.rates.HKD || !data.rates.DKK) throw new Error('API返回無效數據');
    
    // Correct calculation: EUR->HKD = rates.HKD, DKK->HKD = rates.HKD / rates.DKK
    const eurToHkd = data.rates.HKD;
    const dkkToHkd = data.rates.HKD / data.rates.DKK;
    
    const rates = {
      EUR: eurToHkd,
      DKK: dkkToHkd
    };
    const record = { rates: rates, updatedAt: new Date().toISOString() };
    saveRates(record);
    renderRates(record);
    displayError('');
    return record;
  } catch(e) {
    console.error("Fetch rates failed", e);
    displayError("匯率更新失敗：" + e.message + "，使用最後更新資料");
    if (retry < 3) {
      const nextTry = new Date(Date.now()+30000).toLocaleTimeString('zh-HK');
      displayError("匯率更新失敗：" + e.message + "，30秒後重試 ("+nextTry+")");
      setTimeout(() => fetchExchangeRates(retry + 1), 30000);
    }
    return loadRates();
  }
}
function renderRates(record) {
  const container = document.getElementById('exchange-rates') || document.createElement('div');
  container.id = 'exchange-rates';
  const dateStr = record.updatedAt ? new Date(record.updatedAt).toLocaleString('zh-HK') : '無更新';
  container.innerHTML = `匯率更新時間：${dateStr}<br>EUR → HKD: ${record.rates.EUR.toFixed(2)}<br>DKK → HKD: ${record.rates.DKK.toFixed(2)}`;
  document.body.appendChild(container);
}

// Weather
function saveWeather(weather) {
  localStorage.setItem('weatherData', JSON.stringify(weather));
}
function loadWeather() {
  const data = localStorage.getItem('weatherData');
  return data ? JSON.parse(data) : {};
}
async function fetchWeather(city) {
  try {
    const coords = {
      "Copenhagen": {lat:55.6761, lon:12.5683},
      "Helsinki": {lat:60.1699, lon:24.9384},
      "Tallinn": {lat:59.4370, lon:24.7536}
    };
    const loc = coords[city] || coords["Copenhagen"];
    const url = `https://api.open-meteo.com/v1/forecast?latitude=${loc.lat}&longitude=${loc.lon}&current_weather=true`;
    const res = await fetch(url);
    const data = await res.json();
    const temp = data.current_weather.temperature;
    const zh = "晴";
    const weather = { city, temp, desc: zh, updatedAt: new Date().toISOString() };
    saveWeather(weather);
    renderWeather(weather);
    return weather;
  } catch(e) {
    console.error("Fetch weather failed", e);
    displayError("天氣更新失敗：" + e.message);
    return loadWeather();
  }
}
function renderWeather(weather) {
  const container = document.getElementById('weather-info') || document.createElement('div');
  container.id = 'weather-info';
  const dateStr = weather.updatedAt ? new Date(weather.updatedAt).toLocaleString('zh-HK') : '無更新';
  container.innerHTML = `${dateStr}  ${weather.city}：${weather.temp}°C ☀️ ${weather.desc}`;
  document.body.insertBefore(container, document.body.firstChild);
}

// Initialize
window.addEventListener('DOMContentLoaded', async () => {
  const rates = await fetchExchangeRates();
  renderRates(rates);
  const weather = await fetchWeather('Copenhagen');
  renderWeather(weather);
});
        </script><script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js').then(() => {
    console.log('Service Worker Registered');
  });
}
</script></body></html>